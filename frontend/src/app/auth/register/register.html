<div class="card">
  <div class="language-switcher-container">
    <app-language-switcher></app-language-switcher>
  </div>
  <div class="flex-content">
    <div class="form-content">
      @if (isLoading()) {
        <div class="spinner">
          <p-progress-spinner ariaLabel="loading" />
        </div>
      } @else {
        <h2>{{ translationService.translate("register.title") }}</h2>

        <form
          [formGroup]="registerFormGroup"
          class="form"
          (ngSubmit)="onRegisterFormSubmit()"
          class="parent"
        >
          <app-input-for-auth
            label="Name"
            labelKey="register.form.name"
            type="text"
            [control]="registerFormGroup.controls.name"
            class="div1"
          />
          <app-input-for-auth
            label="Surname"
            labelKey="register.form.surname"
            type="text"
            [control]="registerFormGroup.controls.surname"
            class="div2"
          />

          <app-input-for-auth
            label="Goverment ID"
            labelKey="register.form.govermentId"
            type="text"
            class="govId"
            [control]="registerFormGroup.controls.govID"
            class="div7"
          />
          <app-input-for-auth
            label="Birth Date"
            labelKey="register.form.birthDate"
            class="date"
            type="text"
            placeholder="DD-MM-YYYY"
            placeholderKey="register.placeholders.birthDate"
            [control]="registerFormGroup.controls.birthDate"
            class="div3"
          />

          <app-select-with-search
            label="Province"
            [options]="proviceOptions()"
            labelKey="register.form.province"
            type="text"
            [control]="registerFormGroup.controls.province"
            class="div4"
            [loadDataFunction]="null"
            [showDropdownButton]="true"
          />
          <app-input-for-auth
            label="Postal code"
            labelKey="register.form.postalCode"
            type="text"
            placeholder="XX-XXX"
            placeholderKey="register.placeholders.postalCode"
            [control]="registerFormGroup.controls.postalCode"
            class="div5"
          />

          <app-select-with-search
            label="city"
            labelKey="register.form.city"
            [control]="registerFormGroup.controls.city"
            [loadDataFunction]="loadCities"
            placeholder="Select city..."
            class="div6"
            [showDropdownButton]="false"
          />

          <app-input-for-auth
            class="div8"
            label="Number"
            labelKey="register.form.number"
            type="text"
            [control]="registerFormGroup.controls.number"
          />

          <app-input-for-auth
            class="div9"
            label="street"
            labelKey="register.form.street"
            type="text"
            [control]="registerFormGroup.controls.street"
          />

          <app-input-for-auth
            label="Phone Number"
            labelKey="register.form.phoneNumber"
            type="text"
            placeholder="XXXXXXXXX"
            placeholderKey="register.placeholders.phoneNumber"
            [control]="registerFormGroup.controls.phoneNumber"
            class="div10"
          />
          <app-input-for-auth
            class="div11"
            label="Email"
            labelKey="register.form.email"
            type="email"
            [control]="registerFormGroup.controls.email"
          />

          <app-input-for-auth
            class="div12"
            label="Password"
            labelKey="register.form.password"
            type="password"
            [control]="registerFormGroup.controls.password"
          />

          <app-input-for-auth
            label="Confirm password"
            labelKey="register.form.confirmPassword"
            type="password"
            [control]="registerFormGroup.controls.confirmPassword"
            [hasCustomError]="confirmPasswordHasError()"
            [customErrorMessage]="
              passwordMismatchError()
                ? translationService.translate('validation.passwordMismatch')
                : ''
            "
            class="div13"
          />

          <div class="div14">
            <div class="checkbox">
              <input
                type="checkbox"
                name="checkbox"
                id="checkbox"
                formControlName="termsChecked"
                (change)="checkBoxNotChecked.set(false)"
              />
              <label for="checkbox">
                {{ translationService.translate("register.form.acceptTerms") }}
                <a href="/terms" target="_blank" class="terms-link">
                  {{ translationService.translate("register.form.termsLink") }}
                </a>
              </label>
            </div>

            @if (checkboxHasError()) {
              <div class="error-message-checkbox">
                {{ translationService.translate("validation.termsRequired") }}
              </div>
            }

            <p-button
              size="large"
              class="button"
              type="submit"
              [label]="translationService.translate('register.form.signUp')"
            ></p-button>
            <span class="login-link"
              ><span>{{
                translationService.translate("register.form.alreadyHaveAccount")
              }}</span>
              <a href="/auth/login">{{
                translationService.translate("register.form.signIn")
              }}</a></span
            >
          </div>
        </form>
      }
    </div>
    <app-image-for-auth
      [imageSrc]="'assets/imageDoctor.png'"
      [title]="translationService.translate('register.hero.title')"
      [subtitle]="translationService.translate('register.hero.subtitle')"
      [homeLabel]="translationService.translate('home')"
      [aboutLabel]="translationService.translate('aboutUs')"
    ></app-image-for-auth>
</div>
<app-modal-dialog
  [visible]="visible()"
  (visibleChange)="visible.set($event)"
  type="success"
  [title]="translationService.translate('register.dialog.success')"
  [messages]="[
    translationService.translate('register.dialog.registered'),
    translationService.translate('register.dialog.goToLogin'),
  ]"
  [buttonLabel]="translationService.translate('register.dialog.signIn')"
  buttonIcon="pi pi-arrow-right"
  buttonIconPos="right"
  (buttonClick)="redirectToLoginPage()"
/>

<app-modal-dialog
  [visible]="hasError().haveError"
  (visibleChange)="
    hasError.set({ haveError: $event, errorMessage: hasError().errorMessage })
  "
  type="error"
  [errorMessage]="hasError().errorMessage"
  buttonLabel="Ok"
  (buttonClick)="hasError.set({ haveError: false, errorMessage: '' })"
/>
