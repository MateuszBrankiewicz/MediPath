<div class="notifications-page">
  <section class="notifications-page__stats">
    <article class="notifications-page__stat-card">
      <span class="notifications-page__stat-label">
        {{ translate("notifications.total") }}
      </span>
      <span class="notifications-page__stat-value">{{ totalCount() }}</span>
      <i class="pi pi-bell notifications-page__stat-icon"></i>
    </article>

    <article class="notifications-page__stat-card">
      <span class="notifications-page__stat-label">
        {{ translate("notifications.unread") }}
      </span>
      <span class="notifications-page__stat-value">{{ unreadCount() }}</span>
      <i class="pi pi-inbox notifications-page__stat-icon"></i>
    </article>

    <article class="notifications-page__stat-card">
      <span class="notifications-page__stat-label">
        {{ translate("notifications.today") }}
      </span>
      <span class="notifications-page__stat-value">{{ todayCount() }}</span>
      <i class="pi pi-calendar notifications-page__stat-icon"></i>
    </article>

    <article class="notifications-page__stat-card">
      <span class="notifications-page__stat-label">
        {{ translate("notifications.readRate") }}
      </span>
      <span class="notifications-page__stat-value">{{ readRate() }}%</span>
      <i class="pi pi-chart-line notifications-page__stat-icon"></i>
    </article>
  </section>

  <section class="notifications-page__toolbar">
    <p-button
      type="button"
      class="notifications-page__toolbar-button"
      icon="pi pi-refresh"
      [label]="translate('notifications.refresh')"
      [loading]="isRefreshing()"
      (onClick)="onRefresh()"
    ></p-button>
    <p-button
      type="button"
      class="notifications-page__toolbar-button"
      icon="pi pi-envelope-open"
      [label]="translate('notifications.markAllAsRead')"
      [disabled]="unreadCount() === 0 || isMarkingAll()"
      [loading]="isMarkingAll()"
      (onClick)="onMarkAllAsRead()"
    ></p-button>
  </section>

  @if (!hasNotifications()) {
    <p class="notifications-page__empty">
      {{ translate("notifications.empty") }}
    </p>
  } @else {
    <ul class="notifications-page__list">
      @for (notification of notifications(); track notification.id) {
        <li
          class="notifications-page__item"
          [class.notifications-page__item--unread]="!notification.read"
        >
          <div class="notifications-page__item-header">
            <span class="notifications-page__item-title">
              {{ notification.title || notification.message }}
            </span>
            <span class="notifications-page__item-date">
              {{ notification.createdAt | date: "medium" }}
            </span>
          </div>

          @if (
            !notification.title || notification.title !== notification.message
          ) {
            <p class="notifications-page__item-message">
              {{ notification.message }}
            </p>
          }

          <div class="notifications-page__item-actions">
            @if (!notification.read) {
              <p-button
                type="button"
                icon="pi pi-check"
                size="small"
                [label]="translate('notifications.markAsRead')"
                (onClick)="onMarkAsRead(notification)"
              ></p-button>
            } @else {
              <p-tag
                severity="success"
                [value]="translate('notifications.read')"
              ></p-tag>
            }
          </div>
        </li>
      }
    </ul>
  }
</div>
