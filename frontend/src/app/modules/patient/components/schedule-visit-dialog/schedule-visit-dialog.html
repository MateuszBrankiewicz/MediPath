<div class="schedule-visit-page">
  <p-card>
    <div class="form-container">
      <!-- Doctor Information Section -->
      <div class="form-section">
        <h3 class="section-title">
          <i class="pi pi-user-md"></i>
          {{
            translationService.translate(
              "patient.scheduleVisit.doctorInformation"
            )
          }}
        </h3>
        <div class="form-grid">
          <div class="form-field">
            <span class="field-label">{{
              translationService.translate("patient.scheduleVisit.doctor")
            }}</span>
            <div class="info-value">{{ scheduleData()?.doctorName }}</div>
          </div>
          <div class="form-field">
            <span class="field-label">{{
              translationService.translate("patient.scheduleVisit.institution")
            }}</span>
            <div class="info-value">{{ scheduleData()?.institution }}</div>
          </div>
        </div>
      </div>

      <p-divider />

      <div class="form-section">
        <h3 class="section-title">
          <i class="pi pi-calendar"></i>
          {{
            translationService.translate("patient.scheduleVisit.selectDateTime")
          }}
        </h3>
        <div class="calendar-wrapper">
          <app-calendar-schedule
            (dateTimeSelected)="onDateTimeSelected($event)"
            [availableAppointments]="availableDays()"
            [initialSelectedDate]="scheduleData()?.selectedDate || null"
            [initialSelectedTime]="scheduleData()?.selectedTime || null"
          >
          </app-calendar-schedule>
        </div>
      </div>

      <p-divider />

      <div class="form-section">
        <h3 class="section-title">
          <i class="pi pi-comment"></i>
          {{
            translationService.translate("patient.scheduleVisit.patientRemarks")
          }}
        </h3>
        <div class="form-field full-width">
          <textarea
            pTextarea
            class="remarks-textarea"
            [placeholder]="
              translationService.translate(
                'patient.scheduleVisit.remarksPlaceholder'
              )
            "
            rows="6"
            [ngModel]="scheduleData()?.patientRemarks"
            (ngModelChange)="onRemarksChange($event)"
            [disabled]="isDoctor"
            [readonly]="isDoctor"
          >
          </textarea>
          @if (isDoctor) {
            <small class="field-note">
              {{
                translationService.translate("doctor.schedule.remarksReadOnly")
              }}
            </small>
          }
        </div>
      </div>

      <div class="form-actions">
        <p-button
          [label]="translationService.translate('patient.scheduleVisit.cancel')"
          severity="secondary"
          (onClick)="cancelReschedule()"
          type="button"
        />
        <p-button
          [label]="
            translationService.translate('patient.scheduleVisit.confirm')
          "
          [disabled]="!isFormValid()"
          (onClick)="confirmSchedule()"
          type="button"
        />
      </div>
    </div>
  </p-card>
</div>
